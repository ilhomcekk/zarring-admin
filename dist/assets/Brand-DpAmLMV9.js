import{j as e,r as h,B as R}from"./index-DVCylq0Q.js";import{a as u,c as S}from"./index.es-D1a6A4w_.js";import{B as T,c as Z,r as P}from"./auth-COeWrjcC.js";import{C as D,a as I,b as E,c as F,d as A}from"./CModalTitle-DGooZh2_.js";import{C as H,a as b}from"./CRow-DsUHbXhC.js";import{C as k,a as $}from"./DefaultLayout-DZ7uc0CW.js";import{C as B,a as z}from"./CListGroupItem-C5LCyosc.js";import{C as L}from"./CFormInput-DSAYN9JZ.js";import{C as O}from"./CForm-D11q0zH3.js";import{C as q}from"./CFormLabel-hzNGrAC8.js";import{C as G}from"./CInputGroup-xpHWjSDn.js";import{R as K}from"./index-BykZOzjs.js";import{P as J}from"./PageLoading-BzyQkLAF.js";import{C as Q,a as X,b as M,c as m,d as Y,e as N}from"./CTable-_oTpxpYH.js";import{c as ee}from"./cil-zoom-CDkY_4k-.js";import{C as ae}from"./CPopover-CTWSZCVN.js";import{c as se}from"./cil-trash-CBbKHhHb.js";import{c as re}from"./cil-pen-53d2I-C-.js";import{C as ne,a as U}from"./CPaginationItem-Km6D7boB.js";import{c as le}from"./cil-arrow-left-D66Kb3Zq.js";import{c as ce}from"./cil-arrow-right-CuetXaPY.js";import{C as oe}from"./CCard-DsvGdDII.js";import{C as te}from"./CCardHeader-TZ1QTRXN.js";import{C as ie}from"./CCardTitle-CXhH0zEy.js";import"./cil-lock-locked-DmxpJbVL.js";import"./CFormControlWrapper-BybLwgQS.js";import"./CFormControlValidation-R1UaZUmp.js";import"./getRTLPlacement-DxJ2oLW1.js";import"./getTransitionDurationFromElement-Cpu4p4hx.js";const de=({visible:n,onClose:r,item:s})=>e.jsxs(D,{size:"xl",visible:n,onClose:r,backdrop:"static",children:[e.jsx(I,{children:e.jsxs(E,{children:["Баннер ( ",s==null?void 0:s.id," )"]})}),e.jsx(F,{children:e.jsxs(H,{xs:{gutter:2},children:[e.jsx(b,{xs:{span:6},children:e.jsx(k,{className:"p-2 m-0",color:"primary",children:"Имя"})}),e.jsx(b,{xs:{span:6},children:e.jsx(B,{children:e.jsx(z,{className:"p-2",children:s==null?void 0:s.title_ru})})}),e.jsx(b,{xs:{span:6},children:e.jsx(k,{className:"p-2 m-0",color:"primary",children:"Картинка"})}),e.jsx(b,{xs:{span:6},children:e.jsx(B,{children:e.jsx(z,{className:"p-2",children:e.jsx("img",{src:T+(s==null?void 0:s.img),height:200,alt:""})})})}),e.jsx(b,{xs:{span:6},children:e.jsx(k,{className:"p-2 m-0",color:"primary",children:"Время"})}),e.jsx(b,{xs:{span:6},children:e.jsx(B,{children:e.jsx(z,{className:"p-2",children:s==null?void 0:s.created_at})})})]})})]}),he={list:[],listLoading:!1,detail:{},detailLoading:!1,createLoading:!1,editLoading:!1,deleteLoading:!1},V=Z(n=>({...he,getList:async r=>{n({listLoading:!0});try{const{data:s}=await P.fetchBrand(r);return n({list:s==null?void 0:s.data}),s}catch(s){return s}finally{n({listLoading:!1})}},getDetail:async r=>{n({detailLoading:!0});try{const{data:s}=await P.fetchBrandDetail(r);return n({detail:s==null?void 0:s.data}),s}catch(s){return s}finally{n({detailLoading:!1})}},create:async r=>{n({createLoading:!0});try{const{data:s}=await P.createBrand(r);return s}catch(s){return s}finally{n({createLoading:!1})}},edit:async(r,s)=>{n({editLoading:!0});try{const{data:c}=await P.editBrand(r,s);return c}catch(c){return c}finally{n({editLoading:!1})}},remove:async r=>{n({deleteLoading:!0});try{const{data:s}=await P.deleteBrand(r);return s!=null&&s.data&&n(c=>{var p;return{...c,list:(p=c.list)==null?void 0:p.filter(f=>(f==null?void 0:f.id)!==r)}}),s}catch(s){return s}finally{n({deleteLoading:!1})}}})),xe=({visible:n,onClose:r,id:s})=>{var x;const{detail:c,getDetail:p,getList:f,edit:j,editLoading:C}=V(),[o,l]=h.useState({name_ru:"",name_uz:"",img:null,description:""}),[g,w]=h.useState(!1),_=a=>{const{name:i,value:d}=a.target;l({...o,[i]:d})},v=(a,i)=>{const d=a.target.files[0];l({...o,[i]:d})};h.useEffect(()=>{n&&p(s)},[n]),h.useEffect(()=>{l(()=>({name_ru:c==null?void 0:c.name_ru,name_uz:c==null?void 0:c.name_uz,img:c==null?void 0:c.img,description:c==null?void 0:c.description}))},[c]);const y=[{label:"Имя ( RU )",children:e.jsx(L,{name:"name_ru",onChange:_,value:o==null?void 0:o.name_ru,required:!0})},{label:"Имя ( UZ )",children:e.jsx(L,{name:"name_uz",onChange:_,value:o==null?void 0:o.name_uz})},{label:"Основное изображение",children:e.jsxs(e.Fragment,{children:[e.jsx(L,{type:"file",onChange:a=>v(a,"img"),disabled:o==null?void 0:o.img}),e.jsx(u,{color:"danger",onClick:()=>l(a=>({...a,img:""})),children:"Удалить изображение"}),typeof o.img=="string"&&e.jsx("div",{className:"w-100",children:e.jsx("img",{src:T+(o==null?void 0:o.img),alt:"Uploaded",style:{maxWidth:"300px"}})}),((x=o.img)==null?void 0:x.name)&&e.jsx("div",{className:"w-100",children:e.jsx("img",{src:URL.createObjectURL(o.img),alt:"Uploaded",style:{maxWidth:"300px"}})})]})}],t=a=>{a.preventDefault(),a.currentTarget.checkValidity()===!1?(a.preventDefault(),a.stopPropagation()):j(s,o).then(d=>{R.success("Успешно создано"),f({page:1,pageSize:20}),r()}).catch(d=>console.log("err",d)),w(!0)};return e.jsxs(D,{size:"xl",visible:n,onClose:r,backdrop:"static",children:[e.jsx(I,{children:e.jsx(E,{children:"Создать товар"})}),e.jsx(F,{children:e.jsxs(O,{noValidate:!0,validated:g,onSubmit:t,children:[y==null?void 0:y.map((a,i)=>e.jsxs("div",{className:"mt-2",children:[e.jsx(q,{children:a.label}),e.jsx(G,{children:a.children})]},i)),e.jsxs(A,{children:[e.jsx(u,{color:"secondary",onClick:r,children:"Закрыть"}),e.jsx(u,{color:"primary",type:"submit",disabled:C,children:"Сохранить"})]})]})})]})},je=()=>{const{getList:n,list:r,remove:s,deleteLoading:c,listLoading:p}=V(),[f,j]=h.useState({}),[C,o]=h.useState(null),[l,g]=h.useState({page:1,pageSize:20,id:null,name:null,from_to:null}),[w,_]=h.useState(!1),[v,y]=h.useState(!1),t=(a,i)=>{g(d=>({...d,page:1,[a]:i||null}))},x=a=>{a.key==="Enter"&&n(l)};return h.useEffect(()=>{n(l)},[]),e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"overflow-x-auto",children:e.jsxs(Q,{striped:!0,children:[e.jsxs(X,{children:[e.jsxs(M,{children:[e.jsx(m,{scope:"col",children:"ИД"}),e.jsx(m,{scope:"col",children:"Имя"}),e.jsx(m,{scope:"col",children:"Картинка"}),e.jsx(m,{scope:"col",children:"Время"}),e.jsx(m,{scope:"col"})]}),e.jsxs(M,{children:[e.jsx(m,{scope:"col",children:e.jsx(L,{type:"text",value:l==null?void 0:l.id,onChange:a=>t("id",a.target.value),onKeyPress:x})}),e.jsx(m,{scope:"col",children:e.jsx(L,{type:"text",value:l==null?void 0:l.name,onChange:a=>t("name",a.target.value),onKeyPress:x})}),e.jsx(m,{scope:"col"}),e.jsx(m,{scope:"col",children:e.jsxs("div",{className:`d-flex align-items-center ${(l==null?void 0:l.from_to)&&"date-active"}`,children:[e.jsx(K,{onDateSelected:(a,i)=>{const d=Math.floor(new Date(a).getTime()/1e3),W=Math.floor(new Date(i).getTime()/1e3);t("from_to",`${d}-${W}`)},onClose:()=>{const a=Object.fromEntries(Object.entries(l).filter(([i,d])=>d!=null));new URLSearchParams(a).toString(),n(l)}}),(l==null?void 0:l.from_to)&&e.jsx($,{className:"ms-2",onClick:()=>{const a={...l};a.from_to=null,g(a),n(a)}})]})}),e.jsx(m,{scope:"col"})]})]}),e.jsxs(Y,{children:[r==null?void 0:r.map((a,i)=>e.jsxs(M,{children:[e.jsx(m,{scope:"row",children:a==null?void 0:a.id}),e.jsx(N,{children:a==null?void 0:a.name}),e.jsx(N,{children:e.jsx("img",{src:T+(a==null?void 0:a.img),width:50,height:50,alt:""})}),e.jsx(N,{children:a==null?void 0:a.created_at}),e.jsx(N,{children:e.jsxs("div",{className:"d-flex",children:[e.jsx(u,{color:"primary",onClick:()=>{j(a),_(!0)},children:e.jsx(S,{icon:ee})}),e.jsx(ae,{title:a==null?void 0:a.id,trigger:"focus",content:e.jsxs("div",{children:[e.jsx("div",{children:"Вы точно хотите удалить?"}),e.jsx(u,{disabled:c,onClick:()=>s(a==null?void 0:a.id).then(d=>{d!=null&&d.data&&R.success("Успешно удалено")}),color:"danger",className:"mt-2 mx-auto d-flex",children:"Удалить"})]}),children:e.jsx(u,{className:"mx-2",color:"danger",children:e.jsx(S,{icon:se})})}),e.jsx(u,{color:"warning",onClick:()=>{o(a==null?void 0:a.id),y(!0)},children:e.jsx(S,{icon:re})})]})})]},i)),e.jsxs(ne,{children:[e.jsx(U,{onClick:()=>{const a={...l};a.page-=1,g(a),n(a)},disabled:l.page===1,children:e.jsx(S,{icon:le})}),[...Array(r==null?void 0:r.totalPages)].map((a,i)=>e.jsx(U,{onClick:()=>{const d={...l};d.page=i+1,g(d),n(d)},active:l.page===i+1,children:i+1},i)),e.jsx(U,{onClick:()=>{const a={...l};a.page+=1,g(a),n(a)},disabled:l.page===(r==null?void 0:r.totalPages),children:e.jsx(S,{icon:ce})})]})]})]})}),e.jsx(de,{visible:w,onClose:()=>_(!1),item:f}),e.jsx(xe,{visible:v,onClose:()=>y(!1),id:C}),e.jsx(J,{loading:p})]})},me=({visible:n,onClose:r})=>{const{create:s,createLoading:c,getList:p,list:f}=V(),[j,C]=h.useState({name_ru:"",name_uz:"",img:null}),[o,l]=h.useState(!1),g=()=>{C({name_ru:"",name_uz:"",img:null})},w=t=>{const{name:x,value:a}=t.target;C({...j,[x]:a})},_=(t,x)=>{const a=t.target.files[0];C({...j,[x]:a})},v=[{label:"Имя ( RU )",children:e.jsx(L,{name:"name_ru",value:j.name_ru,onChange:w,required:!0})},{label:"Имя ( UZ )",children:e.jsx(L,{name:"name_uz",value:j.name_uz,onChange:w})},{label:"Основное изображение",children:e.jsxs(e.Fragment,{children:[e.jsx(L,{type:"file",onChange:t=>_(t,"img")}),e.jsx(u,{color:"danger",onClick:()=>C(t=>({...t,img:null})),children:"Удалить"}),j.img&&e.jsx("div",{className:"w-100",children:e.jsx("img",{src:URL.createObjectURL(j.img),alt:"Uploaded",style:{maxWidth:"300px"}})})]})}],y=t=>{t.preventDefault(),t.currentTarget.checkValidity()===!1?(t.preventDefault(),t.stopPropagation()):s(j).then(a=>{var i;(i=a==null?void 0:a.data)!=null&&i.id&&(R.success("Успешно создано"),p({page:1,pageSize:20}),g(),r())}).catch(a=>console.log("err",a)),l(!0)};return e.jsxs(D,{size:"xl",visible:n,onClose:r,backdrop:"static",children:[e.jsx(I,{children:e.jsx(E,{children:"Создать категории"})}),e.jsx(F,{children:e.jsxs(O,{noValidate:!0,validated:o,onSubmit:y,children:[v==null?void 0:v.map((t,x)=>e.jsxs("div",{className:"mt-2",children:[e.jsx(q,{children:t.label}),e.jsx(G,{children:t.children})]},x)),e.jsxs(A,{children:[e.jsx(u,{color:"secondary",children:"Закрыть"}),e.jsx(u,{color:"primary",type:"submit",disabled:c,children:"Сохранить"})]})]})})]})},qe=()=>{const[n,r]=h.useState(!1);return e.jsxs(e.Fragment,{children:[e.jsxs(oe,{children:[e.jsx(te,{children:e.jsxs(H,{children:[e.jsx(b,{className:"d-flex align-items-center",children:e.jsx(ie,{className:"mb-0",children:"Бренды"})}),e.jsx(b,{className:"d-flex justify-content-end",children:e.jsx(u,{color:"primary",onClick:()=>r(!0),children:"Создать"})})]})}),e.jsx(je,{})]}),e.jsx(me,{visible:n,onClose:()=>r(!1)})]})};export{qe as default};
