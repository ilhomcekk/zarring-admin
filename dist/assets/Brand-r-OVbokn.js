import{j as e,r as h,B as U}from"./index-eW-6yITB.js";import{a as g,c as S}from"./index.es-1QyywiA-.js";import{B as D,c as K,r as P}from"./auth-CBhP_LvO.js";import{C as R,a as I,b as F,c as E,d as A}from"./CModalTitle-BP5unADw.js";import{C as H,a as b}from"./CRow-3m-4mWST.js";import{C as k}from"./DefaultLayout-Bz4MAgCX.js";import{C as B,a as z}from"./CListGroupItem-C4lvdBoO.js";import{C as L}from"./CFormInput-L99v4CEH.js";import{C as q}from"./CForm-CtjPMG9S.js";import{C as G}from"./CFormLabel-cQNBQ_G2.js";import{C as W}from"./CInputGroup-Cy2E_5hF.js";import{R as O}from"./index-ipilaper.js";import{P as $}from"./PageLoading-DYCMGmXg.js";import{C as J,a as Q,b as M,c as u,d as X,e as N}from"./CTable-iU6qPHck.js";import{c as Y}from"./cil-zoom-CDkY_4k-.js";import{C as ee}from"./CPopover-B52llp3c.js";import{c as ae,a as se}from"./cil-trash-DqRniO5f.js";import{C as re,a as T}from"./CPaginationItem-Dxu5LM3y.js";import{c as ne}from"./cil-arrow-left-D66Kb3Zq.js";import{c as le}from"./cil-arrow-right-CuetXaPY.js";import{C as ce}from"./CCard-Czglc9r9.js";import{C as oe}from"./CCardHeader-CzZi6ULY.js";import{C as te}from"./CCardTitle-B-C91L6L.js";import"./cil-lock-locked-DmxpJbVL.js";import"./CFormControlWrapper-Dxe1bfDj.js";import"./CFormControlValidation-LxJhmD-X.js";import"./getRTLPlacement-Cwl9A_xm.js";import"./getTransitionDurationFromElement-Cpu4p4hx.js";const ie=({visible:n,onClose:r,item:s})=>e.jsxs(R,{size:"xl",visible:n,onClose:r,backdrop:"static",children:[e.jsx(I,{children:e.jsxs(F,{children:["Баннер ( ",s==null?void 0:s.id," )"]})}),e.jsx(E,{children:e.jsxs(H,{xs:{gutter:2},children:[e.jsx(b,{xs:{span:6},children:e.jsx(k,{className:"p-2 m-0",color:"primary",children:"Имя"})}),e.jsx(b,{xs:{span:6},children:e.jsx(B,{children:e.jsx(z,{className:"p-2",children:s==null?void 0:s.title_ru})})}),e.jsx(b,{xs:{span:6},children:e.jsx(k,{className:"p-2 m-0",color:"primary",children:"Картинка"})}),e.jsx(b,{xs:{span:6},children:e.jsx(B,{children:e.jsx(z,{className:"p-2",children:e.jsx("img",{src:D+(s==null?void 0:s.img),height:200,alt:""})})})}),e.jsx(b,{xs:{span:6},children:e.jsx(k,{className:"p-2 m-0",color:"primary",children:"Время"})}),e.jsx(b,{xs:{span:6},children:e.jsx(B,{children:e.jsx(z,{className:"p-2",children:s==null?void 0:s.created_at})})})]})})]}),de={list:[],listLoading:!1,detail:{},detailLoading:!1,createLoading:!1,editLoading:!1,deleteLoading:!1},V=K(n=>({...de,getList:async r=>{n({listLoading:!0});try{const{data:s}=await P.fetchBrand(r);return n({list:s==null?void 0:s.data}),s}catch(s){return s}finally{n({listLoading:!1})}},getDetail:async r=>{n({detailLoading:!0});try{const{data:s}=await P.fetchBrandDetail(r);return n({detail:s==null?void 0:s.data}),s}catch(s){return s}finally{n({detailLoading:!1})}},create:async r=>{n({createLoading:!0});try{const{data:s}=await P.createBrand(r);return s}catch(s){return s}finally{n({createLoading:!1})}},edit:async(r,s)=>{n({editLoading:!0});try{const{data:c}=await P.editBrand(r,s);return c}catch(c){return c}finally{n({editLoading:!1})}},remove:async r=>{n({deleteLoading:!0});try{const{data:s}=await P.deleteBrand(r);return s!=null&&s.data&&n(c=>{var m;return{...c,list:(m=c.list)==null?void 0:m.filter(p=>(p==null?void 0:p.id)!==r)}}),s}catch(s){return s}finally{n({deleteLoading:!1})}}})),he=({visible:n,onClose:r,id:s})=>{var x;const{detail:c,getDetail:m,getList:p,edit:j,editLoading:f}=V(),[o,l]=h.useState({name_ru:"",name_uz:"",img:null,description:""}),[C,w]=h.useState(!1),_=a=>{const{name:i,value:d}=a.target;l({...o,[i]:d})},v=(a,i)=>{const d=a.target.files[0];l({...o,[i]:d})};h.useEffect(()=>{n&&m(s)},[n]),h.useEffect(()=>{l(()=>({name_ru:c==null?void 0:c.name_ru,name_uz:c==null?void 0:c.name_uz,img:c==null?void 0:c.img,description:c==null?void 0:c.description}))},[c]);const y=[{label:"Имя ( RU )",children:e.jsx(L,{name:"name_ru",onChange:_,value:o==null?void 0:o.name_ru,required:!0})},{label:"Имя ( UZ )",children:e.jsx(L,{name:"name_uz",onChange:_,value:o==null?void 0:o.name_uz})},{label:"Основное изображение",children:e.jsxs(e.Fragment,{children:[e.jsx(L,{type:"file",onChange:a=>v(a,"img"),disabled:o==null?void 0:o.img}),e.jsx(g,{color:"danger",onClick:()=>l(a=>({...a,img:""})),children:"Удалить изображение"}),typeof o.img=="string"&&e.jsx("div",{className:"w-100",children:e.jsx("img",{src:D+(o==null?void 0:o.img),alt:"Uploaded",style:{maxWidth:"300px"}})}),((x=o.img)==null?void 0:x.name)&&e.jsx("div",{className:"w-100",children:e.jsx("img",{src:URL.createObjectURL(o.img),alt:"Uploaded",style:{maxWidth:"300px"}})})]})}],t=a=>{a.preventDefault(),a.currentTarget.checkValidity()===!1?(a.preventDefault(),a.stopPropagation()):j(s,o).then(d=>{U.success("Успешно создано"),p({page:1,pageSize:20}),r()}).catch(d=>console.log("err",d)),w(!0)};return e.jsxs(R,{size:"xl",visible:n,onClose:r,backdrop:"static",children:[e.jsx(I,{children:e.jsx(F,{children:"Создать товар"})}),e.jsx(E,{children:e.jsxs(q,{noValidate:!0,validated:C,onSubmit:t,children:[y==null?void 0:y.map((a,i)=>e.jsxs("div",{className:"mt-2",children:[e.jsx(G,{children:a.label}),e.jsx(W,{children:a.children})]},i)),e.jsxs(A,{children:[e.jsx(g,{color:"secondary",onClick:r,children:"Закрыть"}),e.jsx(g,{color:"primary",type:"submit",disabled:f,children:"Сохранить"})]})]})})]})},xe=()=>{const{getList:n,list:r,remove:s,deleteLoading:c,listLoading:m}=V(),[p,j]=h.useState({}),[f,o]=h.useState(null),[l,C]=h.useState({page:1,pageSize:20,id:null,name:null,from_to:null}),[w,_]=h.useState(!1),[v,y]=h.useState(!1),t=(a,i)=>{C(d=>({...d,page:1,[a]:i||null}))},x=a=>{a.key==="Enter"&&n(l)};return h.useEffect(()=>{n(l)},[]),e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"overflow-x-auto",children:e.jsxs(J,{striped:!0,children:[e.jsxs(Q,{children:[e.jsxs(M,{children:[e.jsx(u,{scope:"col",children:"ИД"}),e.jsx(u,{scope:"col",children:"Имя"}),e.jsx(u,{scope:"col",children:"Картинка"}),e.jsx(u,{scope:"col",children:"Время"}),e.jsx(u,{scope:"col"})]}),e.jsxs(M,{children:[e.jsx(u,{scope:"col",children:e.jsx(L,{type:"text",value:l==null?void 0:l.id,onChange:a=>t("id",a.target.value),onKeyPress:x})}),e.jsx(u,{scope:"col",children:e.jsx(L,{type:"text",value:l==null?void 0:l.name,onChange:a=>t("name",a.target.value),onKeyPress:x})}),e.jsx(u,{scope:"col"}),e.jsx(u,{scope:"col",children:e.jsx(O,{onDateSelected:(a,i)=>{const d=Math.floor(new Date(a).getTime()/1e3),Z=Math.floor(new Date(i).getTime()/1e3);t("from_to",`${d}-${Z}`)},onClose:()=>{l!=null&&l.from_to&&n({...l,page:1})}})}),e.jsx(u,{scope:"col"})]})]}),e.jsxs(X,{children:[r==null?void 0:r.map((a,i)=>e.jsxs(M,{children:[e.jsx(u,{scope:"row",children:a==null?void 0:a.id}),e.jsx(N,{children:a==null?void 0:a.name}),e.jsx(N,{children:e.jsx("img",{src:D+(a==null?void 0:a.img),width:50,height:50,alt:""})}),e.jsx(N,{children:a==null?void 0:a.created_at}),e.jsx(N,{children:e.jsxs("div",{className:"d-flex",children:[e.jsx(g,{color:"primary",onClick:()=>{j(a),_(!0)},children:e.jsx(S,{icon:Y})}),e.jsx(ee,{title:a==null?void 0:a.id,trigger:"focus",content:e.jsxs("div",{children:[e.jsx("div",{children:"Вы точно хотите удалить?"}),e.jsx(g,{disabled:c,onClick:()=>s(a==null?void 0:a.id).then(d=>{d!=null&&d.data&&U.success("Успешно удалено")}),color:"danger",className:"mt-2",children:"Удалить"})]}),children:e.jsx(g,{className:"mx-2",color:"danger",children:e.jsx(S,{icon:ae})})}),e.jsx(g,{color:"warning",onClick:()=>{o(a==null?void 0:a.id),y(!0)},children:e.jsx(S,{icon:se})})]})})]},i)),e.jsxs(re,{children:[e.jsx(T,{onClick:()=>{const a={...l};a.page-=1,C(a),n(a)},disabled:l.page===1,children:e.jsx(S,{icon:ne})}),[...Array(r==null?void 0:r.totalPages)].map((a,i)=>e.jsx(T,{onClick:()=>{const d={...l};d.page=i+1,C(d),n(d)},active:l.page===i+1,children:i+1},i)),e.jsx(T,{onClick:()=>{const a={...l};a.page+=1,C(a),n(a)},disabled:l.page===(r==null?void 0:r.totalPages),children:e.jsx(S,{icon:le})})]})]})]})}),e.jsx(ie,{visible:w,onClose:()=>_(!1),item:p}),e.jsx(he,{visible:v,onClose:()=>y(!1),id:f}),e.jsx($,{loading:m})]})},je=({visible:n,onClose:r})=>{const{create:s,createLoading:c,getList:m,list:p}=V(),[j,f]=h.useState({name_ru:"",name_uz:"",img:null}),[o,l]=h.useState(!1),C=()=>{f({name_ru:"",name_uz:"",img:null})},w=t=>{const{name:x,value:a}=t.target;f({...j,[x]:a})},_=(t,x)=>{const a=t.target.files[0];f({...j,[x]:a})},v=[{label:"Имя ( RU )",children:e.jsx(L,{name:"name_ru",value:j.name_ru,onChange:w,required:!0})},{label:"Имя ( UZ )",children:e.jsx(L,{name:"name_uz",value:j.name_uz,onChange:w})},{label:"Основное изображение",children:e.jsxs(e.Fragment,{children:[e.jsx(L,{type:"file",onChange:t=>_(t,"img")}),e.jsx(g,{color:"danger",onClick:()=>f(t=>({...t,img:null})),children:"Удалить"}),j.img&&e.jsx("div",{className:"w-100",children:e.jsx("img",{src:URL.createObjectURL(j.img),alt:"Uploaded",style:{maxWidth:"300px"}})})]})}],y=t=>{t.preventDefault(),t.currentTarget.checkValidity()===!1?(t.preventDefault(),t.stopPropagation()):s(j).then(a=>{var i;(i=a==null?void 0:a.data)!=null&&i.id&&(U.success("Успешно создано"),m({page:1,pageSize:20}),C(),r())}).catch(a=>console.log("err",a)),l(!0)};return e.jsxs(R,{size:"xl",visible:n,onClose:r,backdrop:"static",children:[e.jsx(I,{children:e.jsx(F,{children:"Создать категории"})}),e.jsx(E,{children:e.jsxs(q,{noValidate:!0,validated:o,onSubmit:y,children:[v==null?void 0:v.map((t,x)=>e.jsxs("div",{className:"mt-2",children:[e.jsx(G,{children:t.label}),e.jsx(W,{children:t.children})]},x)),e.jsxs(A,{children:[e.jsx(g,{color:"secondary",children:"Закрыть"}),e.jsx(g,{color:"primary",type:"submit",disabled:c,children:"Сохранить"})]})]})})]})},He=()=>{const[n,r]=h.useState(!1);return e.jsxs(e.Fragment,{children:[e.jsxs(ce,{children:[e.jsx(oe,{children:e.jsxs(H,{children:[e.jsx(b,{className:"d-flex align-items-center",children:e.jsx(te,{className:"mb-0",children:"Бренды"})}),e.jsx(b,{className:"d-flex justify-content-end",children:e.jsx(g,{color:"primary",onClick:()=>r(!0),children:"Создать"})})]})}),e.jsx(xe,{})]}),e.jsx(je,{visible:n,onClose:()=>r(!1)})]})};export{He as default};
