import{j as e,r as h,B as D}from"./index-eW-6yITB.js";import{a as p,c as N}from"./index.es-1QyywiA-.js";import{B as F}from"./auth-CBhP_LvO.js";import{C as E,a as B,b as V,c as A,d as H}from"./CModalTitle-BP5unADw.js";import{C as G,a as b}from"./CRow-3m-4mWST.js";import{C as z}from"./DefaultLayout-Bz4MAgCX.js";import{C as M,a as T}from"./CListGroupItem-C4lvdBoO.js";import{c as L}from"./category-Cp1qaDYF.js";import{C as y}from"./CFormInput-L99v4CEH.js";import{C as W}from"./CFormSelect-ymNHTX0_.js";import{C as Z}from"./CForm-CtjPMG9S.js";import{C as q}from"./CFormLabel-cQNBQ_G2.js";import{C as K}from"./CInputGroup-Cy2E_5hF.js";import{R as O}from"./index-ipilaper.js";import{P as $}from"./PageLoading-DYCMGmXg.js";import{C as J,a as Q,b as U,c as j,d as X,e as k}from"./CTable-iU6qPHck.js";import{c as Y}from"./cil-zoom-CDkY_4k-.js";import{C as ee}from"./CPopover-B52llp3c.js";import{c as se,a as le}from"./cil-trash-DqRniO5f.js";import{C as ae,a as R}from"./CPaginationItem-Dxu5LM3y.js";import{c as re}from"./cil-arrow-left-D66Kb3Zq.js";import{c as ne}from"./cil-arrow-right-CuetXaPY.js";import{C as oe}from"./CCard-Czglc9r9.js";import{C as ce}from"./CCardHeader-CzZi6ULY.js";import{C as te}from"./CCardTitle-B-C91L6L.js";import"./cil-lock-locked-DmxpJbVL.js";import"./CFormControlWrapper-Dxe1bfDj.js";import"./CFormControlValidation-LxJhmD-X.js";import"./getRTLPlacement-Cwl9A_xm.js";import"./getTransitionDurationFromElement-Cpu4p4hx.js";const ie=({visible:t,onClose:c,item:o})=>e.jsxs(E,{size:"xl",visible:t,onClose:c,backdrop:"static",children:[e.jsx(B,{children:e.jsxs(V,{children:["Товар ( ",o==null?void 0:o.id," )"]})}),e.jsx(A,{children:e.jsxs(G,{xs:{gutter:2},children:[e.jsx(b,{xs:{span:6},children:e.jsx(z,{className:"p-2 m-0",color:"primary",children:"Имя"})}),e.jsx(b,{xs:{span:6},children:e.jsx(M,{children:e.jsx(T,{className:"p-2",children:o==null?void 0:o.title_ru})})}),e.jsx(b,{xs:{span:6},children:e.jsx(z,{className:"p-2 m-0",color:"primary",children:"Картинка"})}),e.jsx(b,{xs:{span:6},children:e.jsx(M,{children:e.jsx(T,{className:"p-2",children:e.jsx("img",{src:F+(o==null?void 0:o.img),height:200,alt:""})})})}),e.jsx(b,{xs:{span:6},children:e.jsx(z,{className:"p-2 m-0",color:"primary",children:"Время"})}),e.jsx(b,{xs:{span:6},children:e.jsx(M,{children:e.jsx(T,{className:"p-2",children:o==null?void 0:o.created_at})})})]})})]}),de=({visible:t,onClose:c,id:o})=>{var s,n;const{detail:i,getDetail:w,getList:_,categoryParents:v,edit:d,editLoading:g}=L(),[l,x]=h.useState({title_ru:"",title_uz:"",img:null,description:""}),[I,m]=h.useState(!1),S=a=>{const{name:f,value:P}=a.target;x({...l,[f]:P})},C=(a,f)=>{const P=a.target.files[0];x({...l,[f]:P})};h.useEffect(()=>{t&&w(o)},[t]),h.useEffect(()=>{x(()=>({title_ru:i==null?void 0:i.title_ru,title_uz:i==null?void 0:i.title_uz,img:i==null?void 0:i.img}))},[i]),console.log((s=l.img)==null?void 0:s.name);const u=[{label:"Имя ( RU )",children:e.jsx(y,{name:"title_ru",onChange:S,value:l==null?void 0:l.title_ru,required:!0})},{label:"Имя ( UZ )",children:e.jsx(y,{name:"title_uz",onChange:S,value:l==null?void 0:l.title_uz})},{label:"Категория",children:e.jsx(W,{value:l==null?void 0:l.parentId,name:"parentId",onChange:S,options:["",...v==null?void 0:v.map(a=>({label:a==null?void 0:a.title,value:a==null?void 0:a.id}))]})},{label:"Основное изображение",children:e.jsxs(e.Fragment,{children:[e.jsx(y,{type:"file",onChange:a=>C(a,"img"),disabled:l==null?void 0:l.img}),e.jsx(p,{color:"danger",onClick:()=>x(a=>({...a,img:""})),children:"Удалить изображение"}),typeof l.img=="string"&&e.jsx("div",{className:"w-100",children:e.jsx("img",{src:F+(l==null?void 0:l.img),alt:"Uploaded",style:{maxWidth:"300px"}})}),((n=l.img)==null?void 0:n.name)&&e.jsx("div",{className:"w-100",children:e.jsx("img",{src:URL.createObjectURL(l.img),alt:"Uploaded",style:{maxWidth:"300px"}})})]})}],r=a=>{a.preventDefault(),a.currentTarget.checkValidity()===!1?(a.preventDefault(),a.stopPropagation()):d(o,l).then(P=>{console.log(P),D.success("Успешно создано"),_({page:1,pageSize:20}),c()}).catch(P=>console.log("err",P)),m(!0)};return e.jsxs(E,{size:"xl",visible:t,onClose:c,backdrop:"static",children:[e.jsx(B,{children:e.jsx(V,{children:"Создать товар"})}),e.jsx(A,{children:e.jsxs(Z,{noValidate:!0,validated:I,onSubmit:r,children:[u==null?void 0:u.map((a,f)=>e.jsxs("div",{className:"mt-2",children:[e.jsx(q,{children:a.label}),e.jsx(K,{children:a.children})]},f)),e.jsxs(H,{children:[e.jsx(p,{color:"secondary",onClick:c,children:"Закрыть"}),e.jsx(p,{color:"primary",type:"submit",disabled:g,children:"Сохранить"})]})]})})]})},he=()=>{const{getList:t,list:c,remove:o,deleteLoading:i,listLoading:w}=L(),[_,v]=h.useState({}),[d,g]=h.useState(null),[l,x]=h.useState({id:null,title:null,from_to:null}),[I,m]=h.useState(!1),[S,C]=h.useState(!1),u=(s,n)=>{x(a=>({...a,[s]:n||null}))},r=s=>{s.key==="Enter"&&t(l)};return h.useEffect(()=>{t(l)},[]),e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"overflow-x-auto",children:e.jsxs(J,{striped:!0,children:[e.jsxs(Q,{children:[e.jsxs(U,{children:[e.jsx(j,{scope:"col",children:"ИД"}),e.jsx(j,{scope:"col",children:"Имя"}),e.jsx(j,{scope:"col",children:"Картинка"}),e.jsx(j,{scope:"col",children:"Время"}),e.jsx(j,{scope:"col"})]}),e.jsxs(U,{children:[e.jsx(j,{scope:"col",children:e.jsx(y,{type:"text",value:l==null?void 0:l.id,onChange:s=>u("id",s.target.value),onKeyPress:r})}),e.jsx(j,{scope:"col",children:e.jsx(y,{type:"text",value:l==null?void 0:l.name,onChange:s=>u("title",s.target.value),onKeyPress:r})}),e.jsx(j,{scope:"col"}),e.jsx(j,{scope:"col",children:e.jsx(O,{onDateSelected:(s,n)=>{const a=Math.floor(new Date(s).getTime()/1e3),f=Math.floor(new Date(n).getTime()/1e3);u("from_to",`${a}-${f}`)},onClose:()=>{t(l)}})}),e.jsx(j,{scope:"col"})]})]}),e.jsxs(X,{children:[c==null?void 0:c.map((s,n)=>e.jsxs(U,{children:[e.jsx(j,{scope:"row",children:s==null?void 0:s.id}),e.jsx(k,{children:s==null?void 0:s.title}),e.jsx(k,{children:e.jsx("img",{src:F+(s==null?void 0:s.img),width:50,height:50,alt:""})}),e.jsx(k,{children:s==null?void 0:s.created_at}),e.jsx(k,{children:e.jsxs("div",{className:"d-flex",children:[e.jsx(p,{color:"primary",onClick:()=>{v(s),m(!0)},children:e.jsx(N,{icon:Y})}),e.jsx(ee,{title:s==null?void 0:s.id,trigger:"focus",content:e.jsxs("div",{children:[e.jsx("div",{children:"Вы точно хотите удалить?"}),e.jsx(p,{disabled:i,onClick:()=>o(s==null?void 0:s.id).then(a=>{a!=null&&a.data&&D.success("Успешно удалено")}),color:"danger",className:"mt-2",children:"Удалить"})]}),children:e.jsx(p,{className:"mx-2",color:"danger",children:e.jsx(N,{icon:se})})}),e.jsx(p,{color:"warning",onClick:()=>{g(s==null?void 0:s.id),C(!0)},children:e.jsx(N,{icon:le})})]})})]},n)),e.jsxs(ae,{children:[e.jsx(R,{onClick:()=>{const s={...l};s.page-=1,x(s),t(s)},disabled:l.page===1,children:e.jsx(N,{icon:re})}),[...Array(c==null?void 0:c.totalPages)].map((s,n)=>e.jsx(R,{onClick:()=>{const a={...l};a.page=n+1,x(a),t(a)},active:l.page===n+1,children:n+1},n)),e.jsx(R,{onClick:()=>{const s={...l};s.page+=1,x(s),t(s)},disabled:l.page===(c==null?void 0:c.totalPages),children:e.jsx(N,{icon:ne})})]})]})]})}),e.jsx(ie,{visible:I,onClose:()=>m(!1),item:_}),e.jsx(de,{visible:S,onClose:()=>C(!1),id:d}),e.jsx($,{loading:w})]})},xe=({visible:t,onClose:c})=>{const{create:o,createLoading:i,getList:w,categoryParents:_,getParents:v}=L(),[d,g]=h.useState({title_ru:"",title_uz:"",img:null,parentId:null,description_ru:"",description_uz:""}),[l,x]=h.useState(!1),I=()=>{g({title_ru:"",title_uz:"",img:null,parentId:null,description_ru:"",description_uz:""})},m=r=>{const{name:s,value:n}=r.target;g({...d,[s]:n})},S=(r,s)=>{const n=r.target.files[0];g({...d,[s]:n})},C=[{label:"Имя ( RU )",children:e.jsx(y,{name:"title_ru",value:d.title_ru,onChange:m,required:!0})},{label:"Имя ( UZ )",children:e.jsx(y,{name:"title_uz",value:d.title_uz,onChange:m})},{label:"Категория",children:e.jsx(W,{value:d==null?void 0:d.parentId,name:"parentId",onChange:m,options:["",..._==null?void 0:_.map(r=>({label:r==null?void 0:r.title,value:r==null?void 0:r.id}))]})},{label:"Основное изображение",children:e.jsxs(e.Fragment,{children:[e.jsx(y,{type:"file",onChange:r=>S(r,"img")}),e.jsx(p,{color:"danger",onClick:()=>g(r=>({...r,img:null})),children:"Удалить"}),d.img&&e.jsx("div",{className:"w-100",children:e.jsx("img",{src:URL.createObjectURL(d.img),alt:"Uploaded",style:{maxWidth:"300px"}})})]})}],u=r=>{r.preventDefault(),r.currentTarget.checkValidity()===!1?(r.preventDefault(),r.stopPropagation()):o(d).then(n=>{var a;(a=n==null?void 0:n.data)!=null&&a.id&&(console.log(n),D.success("Успешно создано"),w({}),v(),I(),c())}).catch(n=>console.log("err",n)),x(!0)};return e.jsxs(E,{size:"xl",visible:t,onClose:c,backdrop:"static",children:[e.jsx(B,{children:e.jsx(V,{children:"Создать категории"})}),e.jsx(A,{children:e.jsxs(Z,{noValidate:!0,validated:l,onSubmit:u,children:[C==null?void 0:C.map((r,s)=>e.jsxs("div",{className:"mt-2",children:[e.jsx(q,{children:r.label}),e.jsx(K,{children:r.children})]},s)),e.jsxs(H,{children:[e.jsx(p,{color:"secondary",children:"Закрыть"}),e.jsx(p,{color:"primary",type:"submit",disabled:i,children:"Сохранить"})]})]})})]})},Ge=()=>{const{getParents:t}=L(),[c,o]=h.useState(!1);return h.useEffect(()=>{t()},[]),e.jsxs(e.Fragment,{children:[e.jsxs(oe,{children:[e.jsx(ce,{children:e.jsxs(G,{children:[e.jsx(b,{className:"d-flex align-items-center",children:e.jsx(te,{className:"mb-0",children:"Категории"})}),e.jsx(b,{className:"d-flex justify-content-end",children:e.jsx(p,{color:"primary",onClick:()=>o(!0),children:"Создать"})})]})}),e.jsx(he,{})]}),e.jsx(xe,{visible:c,onClose:()=>o(!1)})]})};export{Ge as default};
