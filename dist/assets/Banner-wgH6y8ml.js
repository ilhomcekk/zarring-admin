import{j as e,r as h,B as G}from"./index-eW-6yITB.js";import{a as g,c as N}from"./index.es-1QyywiA-.js";import{B as R,c as J,r as k}from"./auth-CBhP_LvO.js";import{C as I,a as F,b as E,c as A,d as W}from"./CModalTitle-BP5unADw.js";import{C as Z,a as b}from"./CRow-3m-4mWST.js";import{C as M}from"./DefaultLayout-Bz4MAgCX.js";import{C as T,a as U}from"./CListGroupItem-C4lvdBoO.js";import{C as L}from"./CFormInput-L99v4CEH.js";import{C as K}from"./CForm-CtjPMG9S.js";import{C as O}from"./CFormLabel-cQNBQ_G2.js";import{C as $}from"./CInputGroup-Cy2E_5hF.js";import{R as Q}from"./index-ipilaper.js";import{P as X}from"./PageLoading-DYCMGmXg.js";import{C as Y,a as ee,b as V,c as j,d as ae,e as B}from"./CTable-iU6qPHck.js";import{c as se}from"./cil-zoom-CDkY_4k-.js";import{C as ne}from"./CPopover-B52llp3c.js";import{c as le,a as re}from"./cil-trash-DqRniO5f.js";import{C as ce,a as D}from"./CPaginationItem-Dxu5LM3y.js";import{c as te}from"./cil-arrow-left-D66Kb3Zq.js";import{c as oe}from"./cil-arrow-right-CuetXaPY.js";import{C as ie}from"./CCard-Czglc9r9.js";import{C as de}from"./CCardHeader-CzZi6ULY.js";import{C as he}from"./CCardTitle-B-C91L6L.js";import"./cil-lock-locked-DmxpJbVL.js";import"./CFormControlWrapper-Dxe1bfDj.js";import"./CFormControlValidation-LxJhmD-X.js";import"./getRTLPlacement-Cwl9A_xm.js";import"./getTransitionDurationFromElement-Cpu4p4hx.js";const xe=({visible:l,onClose:n,item:s})=>e.jsxs(I,{size:"xl",visible:l,onClose:n,backdrop:"static",children:[e.jsx(F,{children:e.jsxs(E,{children:["Баннер ( ",s==null?void 0:s.id," )"]})}),e.jsx(A,{children:e.jsxs(Z,{xs:{gutter:2},children:[e.jsx(b,{xs:{span:6},children:e.jsx(M,{className:"p-2 m-0",color:"primary",children:"Имя"})}),e.jsx(b,{xs:{span:6},children:e.jsx(T,{children:e.jsx(U,{className:"p-2",children:s==null?void 0:s.title_ru})})}),e.jsx(b,{xs:{span:6},children:e.jsx(M,{className:"p-2 m-0",color:"primary",children:"Картинка"})}),e.jsx(b,{xs:{span:6},children:e.jsx(T,{children:e.jsx(U,{className:"p-2",children:e.jsx("img",{src:R+(s==null?void 0:s.img),height:200,alt:""})})})}),e.jsx(b,{xs:{span:6},children:e.jsx(M,{className:"p-2 m-0",color:"primary",children:"Время"})}),e.jsx(b,{xs:{span:6},children:e.jsx(T,{children:e.jsx(U,{className:"p-2",children:s==null?void 0:s.created_at})})})]})})]}),ue={list:[],listLoading:!1,detail:{},detailLoading:!1,createLoading:!1,editLoading:!1,deleteLoading:!1},H=J(l=>({...ue,getList:async n=>{l({listLoading:!0});try{const{data:s}=await k.fetchBanner(n);return l({list:s==null?void 0:s.data}),s}catch(s){return s}finally{l({listLoading:!1})}},getDetail:async n=>{l({detailLoading:!0});try{const{data:s}=await k.fetchBannerDetail(n);return l({detail:s==null?void 0:s.data}),s}catch(s){return s}finally{l({detailLoading:!1})}},create:async n=>{l({createLoading:!0});try{const{data:s}=await k.createBanner(n);return s}catch(s){return s}finally{l({createLoading:!1})}},edit:async(n,s)=>{l({editLoading:!0});try{const{data:i}=await k.editBanner(n,s);return i}catch(i){return i}finally{l({editLoading:!1})}},remove:async n=>{l({deleteLoading:!0});try{const{data:s}=await k.deleteBanner(n);return s!=null&&s.data&&l(i=>{var m;return{...i,list:(m=i.list)==null?void 0:m.filter(p=>(p==null?void 0:p.id)!==n)}}),s}catch(s){return s}finally{l({deleteLoading:!1})}}})),je=({visible:l,onClose:n,id:s})=>{var x;const{detail:i,getDetail:m,getList:p,edit:u,editLoading:f}=H(),[o,r]=h.useState({name_ru:"",name_uz:"",img:null}),[C,S]=h.useState(!1),_=a=>{const{name:t,value:c}=a.target;r({...o,[t]:c})},v=(a,t)=>{const c=a.target.files[0];r({...o,[t]:c})};h.useEffect(()=>{l&&m(s)},[l]),h.useEffect(()=>{r(()=>{var a,t,c;return{name_ru:(a=i==null?void 0:i.dataValues)==null?void 0:a.name_ru,name_uz:(t=i==null?void 0:i.dataValues)==null?void 0:t.name_uz,img:(c=i==null?void 0:i.dataValues)==null?void 0:c.img}})},[i]);const y=[{label:"Имя ( RU )",children:e.jsx(L,{name:"name_ru",onChange:_,value:o==null?void 0:o.name_ru,required:!0})},{label:"Имя ( UZ )",children:e.jsx(L,{name:"name_uz",onChange:_,value:o==null?void 0:o.name_uz})},{label:"Основное изображение",children:e.jsxs(e.Fragment,{children:[e.jsx(L,{type:"file",onChange:a=>v(a,"img"),disabled:o==null?void 0:o.img}),e.jsx(g,{color:"danger",onClick:()=>r(a=>({...a,img:""})),children:"Удалить изображение"}),typeof o.img=="string"&&e.jsx("div",{className:"w-100",children:e.jsx("img",{src:R+(o==null?void 0:o.img),alt:"Uploaded",style:{maxWidth:"300px"}})}),((x=o.img)==null?void 0:x.name)&&e.jsx("div",{className:"w-100",children:e.jsx("img",{src:URL.createObjectURL(o.img),alt:"Uploaded",style:{maxWidth:"300px"}})})]})}],d=a=>{a.preventDefault(),a.currentTarget.checkValidity()===!1?(a.preventDefault(),a.stopPropagation()):u(s,o).then(c=>{var w;console.log(c,"asdasdas"),(w=c==null?void 0:c.data)!=null&&w.id&&(toast.success("Успешно создано"),p({page:1,pageSize:20}),n())}).catch(c=>console.log("err",c)),S(!0)};return e.jsxs(I,{size:"xl",visible:l,onClose:n,backdrop:"static",children:[e.jsx(F,{children:e.jsx(E,{children:"Создать товар"})}),e.jsx(A,{children:e.jsxs(K,{noValidate:!0,validated:C,onSubmit:d,children:[y==null?void 0:y.map((a,t)=>e.jsxs("div",{className:"mt-2",children:[e.jsx(O,{children:a.label}),e.jsx($,{children:a.children})]},t)),e.jsxs(W,{children:[e.jsx(g,{color:"secondary",onClick:n,children:"Закрыть"}),e.jsx(g,{color:"primary",type:"submit",disabled:f,children:"Сохранить"})]})]})})]})},ge=()=>{const{getList:l,list:n,remove:s,deleteLoading:i,listLoading:m}=H(),[p,u]=h.useState({}),[f,o]=h.useState(null),[r,C]=h.useState({page:1,pageSize:20,id:null,name:null,from_to:null}),[S,_]=h.useState(!1),[v,y]=h.useState(!1),d=(a,t)=>{C(c=>({...c,page:1,[a]:t||null}))},x=a=>{a.key==="Enter"&&l(r)};return h.useEffect(()=>{l(r)},[]),e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"overflow-x-auto",children:e.jsxs(Y,{striped:!0,children:[e.jsxs(ee,{children:[e.jsxs(V,{children:[e.jsx(j,{scope:"col",children:"ИД"}),e.jsx(j,{scope:"col",children:"Имя"}),e.jsx(j,{scope:"col",children:"Картинка"}),e.jsx(j,{scope:"col",children:"Время"}),e.jsx(j,{scope:"col"})]}),e.jsxs(V,{children:[e.jsx(j,{scope:"col",children:e.jsx(L,{type:"text",value:r==null?void 0:r.id,onChange:a=>d("id",a.target.value),onKeyPress:x})}),e.jsx(j,{scope:"col",children:e.jsx(L,{type:"text",value:r==null?void 0:r.name,onChange:a=>d("name",a.target.value),onKeyPress:x})}),e.jsx(j,{scope:"col"}),e.jsx(j,{scope:"col",children:e.jsx(Q,{onDateSelected:(a,t)=>{const c=Math.floor(new Date(a).getTime()/1e3),w=Math.floor(new Date(t).getTime()/1e3);d("from_to",`${c}-${w}`)},onClose:()=>{r!=null&&r.from_to&&l({...r,page:1})}})}),e.jsx(j,{scope:"col"})]})]}),e.jsxs(ae,{children:[n==null?void 0:n.map((a,t)=>{var c,w,q;return e.jsxs(V,{children:[e.jsx(j,{scope:"row",children:(c=a==null?void 0:a.dataValues)==null?void 0:c.id}),e.jsx(B,{children:a==null?void 0:a.name}),e.jsx(B,{children:e.jsx("img",{src:R+((w=a==null?void 0:a.dataValues)==null?void 0:w.img),width:50,height:50,alt:""})}),e.jsx(B,{children:a==null?void 0:a.created_at}),e.jsx(B,{children:e.jsxs("div",{className:"d-flex",children:[e.jsx(g,{color:"primary",onClick:()=>{u(a),_(!0)},children:e.jsx(N,{icon:se})}),e.jsx(ne,{title:(q=a==null?void 0:a.dataValues)==null?void 0:q.id,trigger:"focus",content:e.jsxs("div",{children:[e.jsx("div",{children:"Вы точно хотите удалить?"}),e.jsx(g,{disabled:i,onClick:()=>{var P;return s((P=a==null?void 0:a.dataValues)==null?void 0:P.id).then(z=>{z!=null&&z.data&&G.success("Успешно удалено")})},color:"danger",className:"mt-2",children:"Удалить"})]}),children:e.jsx(g,{className:"mx-2",color:"danger",children:e.jsx(N,{icon:le})})}),e.jsx(g,{color:"warning",onClick:()=>{var P;o((P=a==null?void 0:a.dataValues)==null?void 0:P.id),y(!0)},children:e.jsx(N,{icon:re})})]})})]},t)}),e.jsxs(ce,{children:[e.jsx(D,{onClick:()=>{const a={...r};a.page-=1,C(a),l(a)},disabled:r.page===1,children:e.jsx(N,{icon:te})}),[...Array(n==null?void 0:n.totalPages)].map((a,t)=>e.jsx(D,{onClick:()=>{const c={...r};c.page=t+1,C(c),l(c)},active:r.page===t+1,children:t+1},t)),e.jsx(D,{onClick:()=>{const a={...r};a.page+=1,C(a),l(a)},disabled:r.page===(n==null?void 0:n.totalPages),children:e.jsx(N,{icon:oe})})]})]})]})}),e.jsx(xe,{visible:S,onClose:()=>_(!1),item:p}),e.jsx(je,{visible:v,onClose:()=>y(!1),id:f}),e.jsx(X,{loading:m})]})},me=({visible:l,onClose:n})=>{const{create:s,createLoading:i,getList:m,list:p}=H(),[u,f]=h.useState({name_ru:"",name_uz:"",img:null}),[o,r]=h.useState(!1),C=()=>{f({name_ru:"",name_uz:"",img:null})},S=d=>{const{name:x,value:a}=d.target;f({...u,[x]:a})},_=(d,x)=>{const a=d.target.files[0];f({...u,[x]:a})},v=[{label:"Имя ( RU )",children:e.jsx(L,{name:"name_ru",value:u.name_ru,onChange:S,required:!0})},{label:"Имя ( UZ )",children:e.jsx(L,{name:"name_uz",value:u.name_uz,onChange:S})},{label:"Основное изображение",children:e.jsxs(e.Fragment,{children:[e.jsx(L,{type:"file",onChange:d=>_(d,"img")}),e.jsx(g,{color:"danger",onClick:()=>f(d=>({...d,img:null})),children:"Удалить"}),u.img&&e.jsx("div",{className:"w-100",children:e.jsx("img",{src:URL.createObjectURL(u.img),alt:"Uploaded",style:{maxWidth:"300px"}})})]})}],y=d=>{d.preventDefault(),d.currentTarget.checkValidity()===!1?(d.preventDefault(),d.stopPropagation()):s(u).then(a=>{var t;(t=a==null?void 0:a.data)!=null&&t.id&&(G.success("Успешно создано"),m({page:1,pageSize:20}),C(),n())}).catch(a=>console.log("err",a)),r(!0)};return e.jsxs(I,{size:"xl",visible:l,onClose:n,backdrop:"static",children:[e.jsx(F,{children:e.jsx(E,{children:"Создать категории"})}),e.jsx(A,{children:e.jsxs(K,{noValidate:!0,validated:o,onSubmit:y,children:[v==null?void 0:v.map((d,x)=>e.jsxs("div",{className:"mt-2",children:[e.jsx(O,{children:d.label}),e.jsx($,{children:d.children})]},x)),e.jsxs(W,{children:[e.jsx(g,{color:"secondary",children:"Закрыть"}),e.jsx(g,{color:"primary",type:"submit",disabled:i,children:"Сохранить"})]})]})})]})},We=()=>{const[l,n]=h.useState(!1);return e.jsxs(e.Fragment,{children:[e.jsxs(ie,{children:[e.jsx(de,{children:e.jsxs(Z,{children:[e.jsx(b,{className:"d-flex align-items-center",children:e.jsx(he,{className:"mb-0",children:"Категории"})}),e.jsx(b,{className:"d-flex justify-content-end",children:e.jsx(g,{color:"primary",onClick:()=>n(!0),children:"Создать"})})]})}),e.jsx(ge,{})]}),e.jsx(me,{visible:l,onClose:()=>n(!1)})]})};export{We as default};
