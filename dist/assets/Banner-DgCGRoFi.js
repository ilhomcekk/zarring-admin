import{j as e,r as x,B as O}from"./index-DVCylq0Q.js";import{a as u,c as k}from"./index.es-D1a6A4w_.js";import{B}from"./auth-COeWrjcC.js";import{C as I,a as D,b as E,c as F,d as G}from"./CModalTitle-DGooZh2_.js";import{C as W,a as b}from"./CRow-DsUHbXhC.js";import{C as z,a as K}from"./DefaultLayout-DZ7uc0CW.js";import{C as M,a as U}from"./CListGroupItem-C5LCyosc.js";import{b as A}from"./banner-TnnKUqNw.js";import{C as y}from"./CFormInput-DSAYN9JZ.js";import{C as Z}from"./CForm-D11q0zH3.js";import{C as $}from"./CFormLabel-hzNGrAC8.js";import{C as q}from"./CInputGroup-xpHWjSDn.js";import{R as J}from"./index-BykZOzjs.js";import{P as Q}from"./PageLoading-BzyQkLAF.js";import{C as X,a as Y,b as R,c as j,d as ee,e as L}from"./CTable-_oTpxpYH.js";import{c as ae}from"./cil-zoom-CDkY_4k-.js";import{C as se}from"./CPopover-CTWSZCVN.js";import{c as le}from"./cil-trash-CBbKHhHb.js";import{c as ne}from"./cil-pen-53d2I-C-.js";import{C as re,a as T}from"./CPaginationItem-Km6D7boB.js";import{c as oe}from"./cil-arrow-left-D66Kb3Zq.js";import{c as ce}from"./cil-arrow-right-CuetXaPY.js";import{C as te}from"./CCard-DsvGdDII.js";import{C as ie}from"./CCardHeader-TZ1QTRXN.js";import{C as de}from"./CCardTitle-CXhH0zEy.js";import"./cil-lock-locked-DmxpJbVL.js";import"./CFormControlWrapper-BybLwgQS.js";import"./CFormControlValidation-R1UaZUmp.js";import"./getRTLPlacement-DxJ2oLW1.js";import"./getTransitionDurationFromElement-Cpu4p4hx.js";const xe=({visible:i,onClose:o,item:t})=>{var d,g,_;return e.jsxs(I,{size:"xl",visible:i,onClose:o,backdrop:"static",children:[e.jsx(D,{children:e.jsxs(E,{children:["Баннер ( ",(d=t==null?void 0:t.dataValues)==null?void 0:d.id," )"]})}),e.jsx(F,{children:e.jsxs(W,{xs:{gutter:2},children:[e.jsx(b,{xs:{span:6},children:e.jsx(z,{className:"p-2 m-0",color:"primary",children:"Имя"})}),e.jsx(b,{xs:{span:6},children:e.jsx(M,{children:e.jsx(U,{className:"p-2",children:t==null?void 0:t.name})})}),e.jsx(b,{xs:{span:6},children:e.jsx(z,{className:"p-2 m-0",color:"primary",children:"Картинка"})}),e.jsx(b,{xs:{span:6},children:e.jsx(M,{children:e.jsx(U,{className:"p-2",children:e.jsx("img",{src:B+((g=t==null?void 0:t.dataValues)==null?void 0:g.img),height:200,alt:""})})})}),e.jsx(b,{xs:{span:6},children:e.jsx(z,{className:"p-2 m-0",color:"primary",children:"Время"})}),e.jsx(b,{xs:{span:6},children:e.jsx(M,{children:e.jsx(U,{className:"p-2",children:(_=t==null?void 0:t.dataValues)==null?void 0:_.created_at})})})]})})]})},he=({visible:i,onClose:o,id:t})=>{var h;const{detail:d,getDetail:g,getList:_,edit:m,editLoading:f}=A(),[r,s]=x.useState({name_ru:"",name_uz:"",img:null}),[p,w]=x.useState(!1),v=a=>{const{name:n,value:l}=a.target;s({...r,[n]:l})},S=(a,n)=>{const l=a.target.files[0];s({...r,[n]:l})};x.useEffect(()=>{i&&g(t)},[i]),x.useEffect(()=>{s(()=>{var a,n,l;return{name_ru:(a=d==null?void 0:d.dataValues)==null?void 0:a.name_ru,name_uz:(n=d==null?void 0:d.dataValues)==null?void 0:n.name_uz,img:(l=d==null?void 0:d.dataValues)==null?void 0:l.img}})},[d]);const C=[{label:"Имя ( RU )",children:e.jsx(y,{name:"name_ru",onChange:v,value:r==null?void 0:r.name_ru,required:!0})},{label:"Имя ( UZ )",children:e.jsx(y,{name:"name_uz",onChange:v,value:r==null?void 0:r.name_uz})},{label:"Основное изображение",children:e.jsxs(e.Fragment,{children:[e.jsx(y,{type:"file",onChange:a=>S(a,"img"),disabled:r==null?void 0:r.img}),e.jsx(u,{color:"danger",onClick:()=>s(a=>({...a,img:""})),children:"Удалить изображение"}),typeof r.img=="string"&&e.jsx("div",{className:"w-100",children:e.jsx("img",{src:B+(r==null?void 0:r.img),alt:"Uploaded",style:{maxWidth:"300px"}})}),((h=r.img)==null?void 0:h.name)&&e.jsx("div",{className:"w-100",children:e.jsx("img",{src:URL.createObjectURL(r.img),alt:"Uploaded",style:{maxWidth:"300px"}})})]})}],c=a=>{a.preventDefault(),a.currentTarget.checkValidity()===!1?(a.preventDefault(),a.stopPropagation()):m(t,r).then(l=>{var P;console.log(l,"asdasdas"),(P=l==null?void 0:l.data)!=null&&P.id&&(toast.success("Успешно создано"),_({page:1,pageSize:20}),o())}).catch(l=>console.log("err",l)),w(!0)};return e.jsxs(I,{size:"xl",visible:i,onClose:o,backdrop:"static",children:[e.jsx(D,{children:e.jsx(E,{children:"Создать товар"})}),e.jsx(F,{children:e.jsxs(Z,{noValidate:!0,validated:p,onSubmit:c,children:[C==null?void 0:C.map((a,n)=>e.jsxs("div",{className:"mt-2",children:[e.jsx($,{children:a.label}),e.jsx(q,{children:a.children})]},n)),e.jsxs(G,{children:[e.jsx(u,{color:"secondary",onClick:o,children:"Закрыть"}),e.jsx(u,{color:"primary",type:"submit",disabled:f,children:"Сохранить"})]})]})})]})},me=()=>{const{getList:i,list:o,remove:t,deleteLoading:d,listLoading:g}=A(),[_,m]=x.useState({}),[f,r]=x.useState(null),[s,p]=x.useState({page:1,pageSize:20,id:null,name:null,from_to:null}),[w,v]=x.useState(!1),[S,C]=x.useState(!1),c=(a,n)=>{p(l=>({...l,page:1,[a]:n||null}))},h=a=>{a.key==="Enter"&&i(s)};return x.useEffect(()=>{i(s)},[]),e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"overflow-x-auto",children:e.jsxs(X,{striped:!0,children:[e.jsxs(Y,{children:[e.jsxs(R,{children:[e.jsx(j,{scope:"col",children:"ИД"}),e.jsx(j,{scope:"col",children:"Имя"}),e.jsx(j,{scope:"col",children:"Картинка"}),e.jsx(j,{scope:"col",children:"Время"}),e.jsx(j,{scope:"col"})]}),e.jsxs(R,{children:[e.jsx(j,{scope:"col",children:e.jsx(y,{type:"text",value:s==null?void 0:s.id,onChange:a=>c("id",a.target.value),onKeyPress:h})}),e.jsx(j,{scope:"col",children:e.jsx(y,{type:"text",value:s==null?void 0:s.name,onChange:a=>c("name",a.target.value),onKeyPress:h})}),e.jsx(j,{scope:"col"}),e.jsx(j,{scope:"col",children:e.jsxs("div",{className:`d-flex align-items-center ${(s==null?void 0:s.from_to)&&"date-active"}`,children:[e.jsx(J,{onDateSelected:(a,n)=>{const l=Math.floor(new Date(a).getTime()/1e3),P=Math.floor(new Date(n).getTime()/1e3);c("from_to",`${l}-${P}`)},onClose:()=>{const a=Object.fromEntries(Object.entries(s).filter(([n,l])=>l!=null));new URLSearchParams(a).toString(),i(s)}}),(s==null?void 0:s.from_to)&&e.jsx(K,{className:"ms-2",onClick:()=>{const a={...s};a.from_to=null,p(a),i(a)}})]})}),e.jsx(j,{scope:"col"})]})]}),e.jsxs(ee,{children:[o==null?void 0:o.map((a,n)=>{var l,P,H;return e.jsxs(R,{children:[e.jsx(j,{scope:"row",children:(l=a==null?void 0:a.dataValues)==null?void 0:l.id}),e.jsx(L,{children:a==null?void 0:a.name}),e.jsx(L,{children:e.jsx("img",{src:B+((P=a==null?void 0:a.dataValues)==null?void 0:P.img),width:50,height:50,alt:""})}),e.jsx(L,{children:a==null?void 0:a.created_at}),e.jsx(L,{children:e.jsxs("div",{className:"d-flex",children:[e.jsx(u,{color:"primary",onClick:()=>{m(a),v(!0)},children:e.jsx(k,{icon:ae})}),e.jsx(se,{title:(H=a==null?void 0:a.dataValues)==null?void 0:H.id,trigger:"focus",content:e.jsxs("div",{children:[e.jsx("div",{children:"Вы точно хотите удалить?"}),e.jsx(u,{disabled:d,onClick:()=>{var N;return t((N=a==null?void 0:a.dataValues)==null?void 0:N.id).then(V=>{V!=null&&V.data&&O.success("Успешно удалено")})},color:"danger",className:"mt-2",children:"Удалить"})]}),children:e.jsx(u,{className:"mx-2",color:"danger",children:e.jsx(k,{icon:le})})}),e.jsx(u,{color:"warning",onClick:()=>{var N;r((N=a==null?void 0:a.dataValues)==null?void 0:N.id),C(!0)},children:e.jsx(k,{icon:ne})})]})})]},n)}),e.jsxs(re,{children:[e.jsx(T,{onClick:()=>{const a={...s};a.page-=1,p(a),i(a)},disabled:s.page===1,children:e.jsx(k,{icon:oe})}),[...Array(o==null?void 0:o.totalPages)].map((a,n)=>e.jsx(T,{onClick:()=>{const l={...s};l.page=n+1,p(l),i(l)},active:s.page===n+1,children:n+1},n)),e.jsx(T,{onClick:()=>{const a={...s};a.page+=1,p(a),i(a)},disabled:s.page===(o==null?void 0:o.totalPages),children:e.jsx(k,{icon:ce})})]})]})]})}),e.jsx(xe,{visible:w,onClose:()=>v(!1),item:_}),e.jsx(he,{visible:S,onClose:()=>C(!1),id:f}),e.jsx(Q,{loading:g})]})},je=({visible:i,onClose:o})=>{const{create:t,createLoading:d,getList:g,list:_}=A(),[m,f]=x.useState({name_ru:"",name_uz:"",img:null}),[r,s]=x.useState(!1),p=()=>{f({name_ru:"",name_uz:"",img:null})},w=c=>{const{name:h,value:a}=c.target;f({...m,[h]:a})},v=(c,h)=>{const a=c.target.files[0];f({...m,[h]:a})},S=[{label:"Имя ( RU )",children:e.jsx(y,{name:"name_ru",value:m.name_ru,onChange:w,required:!0})},{label:"Имя ( UZ )",children:e.jsx(y,{name:"name_uz",value:m.name_uz,onChange:w})},{label:"Основное изображение",children:e.jsxs(e.Fragment,{children:[e.jsx(y,{type:"file",onChange:c=>v(c,"img")}),e.jsx(u,{color:"danger",onClick:()=>f(c=>({...c,img:null})),children:"Удалить"}),m.img&&e.jsx("div",{className:"w-100",children:e.jsx("img",{src:URL.createObjectURL(m.img),alt:"Uploaded",style:{maxWidth:"300px"}})})]})}],C=c=>{c.preventDefault(),c.currentTarget.checkValidity()===!1?(c.preventDefault(),c.stopPropagation()):t(m).then(a=>{var n;(n=a==null?void 0:a.data)!=null&&n.id&&(O.success("Успешно создано"),g({page:1,pageSize:20}),p(),o())}).catch(a=>console.log("err",a)),s(!0)};return e.jsxs(I,{size:"xl",visible:i,onClose:o,backdrop:"static",children:[e.jsx(D,{children:e.jsx(E,{children:"Создать категории"})}),e.jsx(F,{children:e.jsxs(Z,{noValidate:!0,validated:r,onSubmit:C,children:[S==null?void 0:S.map((c,h)=>e.jsxs("div",{className:"mt-2",children:[e.jsx($,{children:c.label}),e.jsx(q,{children:c.children})]},h)),e.jsxs(G,{children:[e.jsx(u,{color:"secondary",children:"Закрыть"}),e.jsx(u,{color:"primary",type:"submit",disabled:d,children:"Сохранить"})]})]})})]})},We=()=>{const[i,o]=x.useState(!1);return e.jsxs(e.Fragment,{children:[e.jsxs(te,{children:[e.jsx(ie,{children:e.jsxs(W,{children:[e.jsx(b,{className:"d-flex align-items-center",children:e.jsx(de,{className:"mb-0",children:"Категории"})}),e.jsx(b,{className:"d-flex justify-content-end",children:e.jsx(u,{color:"primary",onClick:()=>o(!0),children:"Создать"})})]})}),e.jsx(me,{})]}),e.jsx(je,{visible:i,onClose:()=>o(!1)})]})};export{We as default};
